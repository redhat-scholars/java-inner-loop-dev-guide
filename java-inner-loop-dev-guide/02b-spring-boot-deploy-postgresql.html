<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PostgreSQL as Database :: Java Inner Loop Dev Guide</title>
    <link rel="canonical" href="https://redhat-scholars.github.io/java-inner-loop-dev-guide/java-inner-loop-dev-guide/02b-spring-boot-deploy-postgresql.html">
    <link rel="prev" href="02a-spring-boot-common.html">
    <link rel="next" href="02c-spring-boot-deploy-oracle.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img
          src="../_/img/header_logo.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://redhat-scholars.github.io/java-inner-loop-dev-guide">Java Inner Loop Dev Guide</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
        <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-scholars.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-scholars.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-scholars.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="java-inner-loop-dev-guide" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">Java Inner-Loop Dev</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="01-setup.html">Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#prerequisite">Prerequisites</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02a-spring-boot-common.html">Spring Boot Inner-Loop</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02a-spring-boot-common.html">Using H2</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="02a-spring-boot-common.html#the-code">The code</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="02a-spring-boot-common.html#maven-profiles">Maven Profiles</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="02a-spring-boot-common.html#run-local">Running the code locally against H2</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02b-spring-boot-deploy-postgresql.html">Using PostgreSQL</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#deploy-database">Deploying PostgreSQL</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#deploy-code">Deploying the code</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#run-local-telepresence">Extending the inner-loop with Telepresence</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#binary-deploy">Binary deploy (S2I)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02c-spring-boot-deploy-oracle.html">Using Oracle RBDMS</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="02c-spring-boot-deploy-oracle.html#deploy-database">Deploying Oracle</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="02c-spring-boot-deploy-oracle.html#deploy-code">Deploying the code</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="02c-spring-boot-deploy-oracle.html#run-local-telepresence">Extending the inner-loop with Telepresence</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="02c-spring-boot-deploy-oracle.html#binary-deploy">Binary deploy (S2I)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03a-quarkus-common.html">Quarkus Inner-Loop</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03a-quarkus-common.html">Using H2</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03a-quarkus-common.html#the-code">The code</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03a-quarkus-common.html#maven-profiles">Maven Profiles</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03a-quarkus-common.html#run-local">Running the code locally against H2</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03b-quarkus-deploy-postgresql.html">PostgreSQL as Database</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03b-quarkus-deploy-postgresql.html#deploy-database">Deploying PostgreSQL</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03b-quarkus-deploy-postgresql.html#deploy-code">Deploying the code</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03b-quarkus-deploy-postgresql.html#run-local-telepresence">Extending the inner-loop with Telepresence</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03b-quarkus-deploy-postgresql.html#run-local-remote-dev">Extending the inner-loop with remote development</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03b-quarkus-deploy-postgresql.html#binary-deploy">Binary deploy (S2I)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03c-quarkus-deploy-oracle.html">Oracle as Database</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03c-quarkus-deploy-oracle.html#deploy-database">Deploying Oracle</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03c-quarkus-deploy-oracle.html#deploy-code">Deploying the code</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03c-quarkus-deploy-oracle.html#run-local-telepresence">Extending the inner-loop with Telepresence</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03c-quarkus-deploy-oracle.html#run-local-remote-dev">Extending the inner-loop with remote development</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="03c-quarkus-deploy-oracle.html#binary-deploy">Binary deploy (S2I)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Java Inner-Loop Dev</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Java Inner-Loop Dev</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Java Inner-Loop Dev</a></li>
    <li><a href="02a-spring-boot-common.html">Spring Boot Inner-Loop</a></li>
    <li><a href="02b-spring-boot-deploy-postgresql.html">Using PostgreSQL</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-scholars/java-inner-loop-dev-guide/edit/master/documentation/modules/ROOT/pages/02b-spring-boot-deploy-postgresql.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">PostgreSQL as Database</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>So before we deploy the code we need a Database right? For the sake of simplicity let&#8217;s deploy PostgreSQL using some simple <code>oc</code> commands. Maybe in your real deployment you would use an external instance.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploy-database"><a class="anchor" href="#deploy-database"></a>Deploying PostgreSQL on OpenShift</h2>
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Before proceeding log in your cluster using <code>oc login</code> with a normal user no need for special permissions.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to run our application, we need a namespace, let&#8217;s create one:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">export PROJECT_NAME=%USERNAME%-fruit-service-postgresql
oc new-project ${PROJECT_NAME}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order for the application to work properly we must first deploy a <code>PostgreSQL</code> database, like this:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">oc new-app -e POSTGRESQL_USER=luke -e POSTGRESQL_PASSWORD=secret -e POSTGRESQL_DATABASE=FRUITSDB \
  centos/postgresql-10-centos7 --as-deployment-config=true --name=postgresql-db -n ${PROJECT_NAME}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s add some labels to the database deployment object:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">oc label dc/postgresql-db app.kubernetes.io/part-of=fruit-service-app -n ${PROJECT_NAME} &amp;&amp; \
  oc label dc/postgresql-db app.openshift.io/runtime=postgresql --overwrite=true -n ${PROJECT_NAME}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check the database is running:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">oc get pod -n ${PROJECT_NAME}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see something like this:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">NAME                        READY   STATUS      RESTARTS   AGE
postgresql-db-1-deploy      0/1     Completed   0          2d6h
postgresql-db-1-n585q       1/1     Running     0          2d6h</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can also run this command to check the name of the POD:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">oc get pods -n ${PROJECT_NAME} -o json | jq -r '.items[] | select(.status.phase | test("Running")) | select(.metadata.name | test("postgresql-db")).metadata.name'</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploy-code"><a class="anchor" href="#deploy-code"></a>Deploying the code on OpenShift</h2>
<div class="sectionbody">
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">mvn clean oc:deploy -Popenshift-postgresql</code></pre>
</div>
</div>
<div class="paragraph">
<p>Move to the OpenShift web console and from <code>Topology</code> in the <code>Developer</code> perspective click on the route link as in the picture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/fruit-service-postgresql-topology.png" alt="Fruit Service on PostgreSQL Topology">
</div>
</div>
<div class="paragraph">
<p>You should see this.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/fruit-service-postgresql-display.png" alt="Fruit Service on PostgreSQL Topology">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="run-local-telepresence"><a class="anchor" href="#run-local-telepresence"></a>Extending the inner-loop with Telepresence</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Permissions needed</div>
<div class="paragraph">
<p>This needs to be run by a <code>cluster-admin</code></p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">oc adm policy add-scc-to-user privileged -z default -n ${PROJECT_NAME}
oc adm policy add-scc-to-user anyuid -z default -n ${PROJECT_NAME}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Telepresence will modify the network so that Services in Kubernetes are reachable from your laptop and vice versa.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The next command will result in the deployment for our application being scaled down to zero and the network altered so that traffic to it ends up in your laptop in port <code>8080</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You&#8217;ll be asked for <code>sudo</code> password, this is normal, telepresence needs to be able to modify networking rules so that you can see Kubernetes Services as local.
</td>
</tr>
</table>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">export TELEPRESENCE_USE_OCP_IMAGE=NO
oc project ${PROJECT_NAME}
telepresence --swap-deployment fruit-service --expose 8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>Evetually you&#8217;ll se something like this:</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-text hljs" data-lang="text">...
T: Forwarding remote port 9779 to local port 9779.
T: Forwarding remote port 8080 to local port 8080.
T: Forwarding remote port 8778 to local port 8778.

T: Guessing that Services IP range is ['172.30.0.0/16']. Services started after this point will be inaccessible if are outside this range; restart telepresence
T: if you can't access a new Service.
T: Connected. Flushing DNS cache.
T: Setup complete. Launching your command.

The default interactive shell is now zsh.
To update your account to use zsh, please run `chsh -s /bin/zsh`.
For more details, please visit https://support.apple.com/kb/HT208050.
@fruits-postgresql-dev/api-cluster-5555-5555-acme-com:6443/user1|bash-3.2$</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Run from another terminal:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">curl http://postgresql-db:5432</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should receive which looks bad but it&#8217;s actually good, this means that the DNS Service name local to Kubernetes can be resolved from your computer and that the port <code>5432</code> has been reached!</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">curl: (52) Empty reply from server`</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now from another terminal:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">export PROJECT_NAME=%USERNAME%-fruit-service-postgresql
SERVICE_DB_USER=luke SERVICE_DB_PASSWORD=secret SERVICE_DB_NAME=FRUITSDB SERVICE_DB_HOST=postgresql-db \
  mvn clean spring-boot:run -Dspring-boot.run.profiles=openshift-postgresql -Popenshift-postgresql</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now open a browser and point to <a href="http://localhost:8080" target="_blank" rel="noopener">http://localhost:8080</a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can edit, save, delete to test the functionalities implemented by <code>FruitController</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You should see this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/fruit-service-postgresql-display.png" alt="Fruit Service on PostgreSQL">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="binary-deploy"><a class="anchor" href="#binary-deploy"></a>Binary deploy S2I</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Finally, imagine that after debugging your code locally you want to redeploy on OpenShift in a similar way but without using the JKube extension. This is possible because JKube is leveraging Source to Image (S2I) let&#8217;s have a look to the <code>BuildConfigs</code> in our project.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s do this.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">oc get bc -n ${PROJECT_NAME}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And you should get this.</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">NAME                TYPE     FROM     LATEST
fruit-service-s2i   Source   Binary   2</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s read some details:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">oc get bc/fruit-service-s2i -o yaml -n ${PROJECT_NAME}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And you should get this. We have deleted transient or obvious data to focus on the important part of the YAML.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Focus on <code>spec&#8594;source&#8594;type</code> &#8658; <code>Binary</code> this means that in order to build image <code>spec&#8594;output&#8594;to&#8594;name</code> you need to provide a binary file, a <code>JAR</code> file in this case.
</td>
</tr>
</table>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-yaml hljs" data-lang="yaml">apiVersion: build.openshift.io/v1
kind: BuildConfig
metadata:
  labels:
    app: fruit-service
    group: dev.snowdrop.example
    provider: jkube
    version: 1.0.0
  name: fruit-service-s2i
  namespace: fruits-postgresql-dev
  ...
spec:
  failedBuildsHistoryLimit: 5
  nodeSelector: null
  output:
    to:
      kind: ImageStreamTag
      name: fruit-service:1.0.0
  postCommit: {}
  resources: {}
  runPolicy: Serial
  source:
    binary: {}
    type: Binary
  strategy:
    sourceStrategy:
      from:
        kind: DockerImage
        name: registry.access.redhat.com/redhat-openjdk-18/openjdk18-openshift:latest
    type: Source
  successfulBuildsHistoryLimit: 5
status:
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s package our application with the right profile and build an image with it:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">mvn clean package -Popenshift-postgresql</code></pre>
</div>
</div>
<div class="paragraph">
<p>After a successful build, let&#8217;s start the build of the image in OpenShift:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">oc start-build fruit-service-s2i --from-file=./target/fruit-service-1.0.0.jar -n ${PROJECT_NAME}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see in the output the <code>JAR</code> file is uploaded and a new Build is started.</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">Uploading file "target/fruit-service-1.0.0.jar" as binary input for the build ...
...
Uploading finished
build.build.openshift.io/fruit-service-s2i-3 started</code></pre>
</div>
</div>
<div class="paragraph">
<p>And let&#8217;s have a look to the logs while the build is happening:</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">oc logs -f bc/fruit-service-s2i -n ${PROJECT_NAME}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Log output from the current build (only relevant lines):</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It all starts with <code>Receiving source from STDIN as file fruit-service-1.0.0.jar</code> so the image is built from a binary file within OpenShift as we checked out before.
</td>
</tr>
</table>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-bash hljs" data-lang="bash">Receiving source from STDIN as file fruit-service-1.0.0.jar
Caching blobs under "/var/cache/blobs".
Getting image source signatures
...
Writing manifest to image destination
Storing signatures
Generating dockerfile with builder image registry.access.redhat.com/redhat-openjdk-18/openjdk18-openshift:latest
STEP 1: FROM registry.access.redhat.com/redhat-openjdk-18/openjdk18-openshift:latest
STEP 2: LABEL "io.openshift.build.source-location"="/tmp/build/inputs"       "io.openshift.s2i.destination"="/tmp"       "io.openshift.build.image"="registry.access.redhat.com/redhat-openjdk-18/openjdk18-openshift:latest"
STEP 3: ENV OPENSHIFT_BUILD_NAME="fruit-service-s2i-3"     OPENSHIFT_BUILD_NAMESPACE="fruits-postgresql-dev"
STEP 4: USER root
STEP 5: COPY upload/src /tmp/src
STEP 6: RUN chown -R 185:0 /tmp/src
STEP 7: USER 185
STEP 8: RUN /usr/local/s2i/assemble
INFO S2I source build with plain binaries detected
INFO Copying binaries from /tmp/src to /deployments ...
fruit-service-1.0.0.jar
STEP 9: CMD /usr/local/s2i/run
STEP 10: COMMIT temp.builder.openshift.io/fruits-postgresql-dev/fruit-service-s2i-3:5b6ab412
Getting image source signatures
...
Writing manifest to image destination
Storing signatures
--&gt; 56ea06fd4ac
56ea06fd4ac030f9d3356a917c6a31aaa791d6fff000852a4e87eedbf06432ad

Pushing image image-registry.openshift-image-registry.svc:5000/fruits-postgresql-dev/fruit-service:1.0.0 ...
Getting image source signatures
...
Successfully pushed image-registry.openshift-image-registry.svc:5000/fruits-postgresql-dev/fruit-service@sha256:ae0a508200be22c45f3af7d5cd7f7ad32351f480f50b15bc9ad71b76fb37fa54
Push successful</code></pre>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="02a-spring-boot-common.html" class="query-params-link">Spring Boot Inner-Loop</a></span>
  <span class="next"><a href="02c-spring-boot-deploy-oracle.html" class="query-params-link">Using Oracle RBDMS</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
